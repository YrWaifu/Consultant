{% extends "base.html" %}
{% block title %}Результат проверки — AdLaw{% endblock %}
{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
  <!-- Левая колонка -->
  <section class="lg:col-span-9 space-y-4">
    <div class="card">
      <a href="/" class="text-sm text-brand-700">← Назад</a>
      <h1 class="text-xl font-semibold mt-2 mb-1">Результат проверки</h1>

      <div class="grid md:grid-cols-2 gap-6 items-start">
        <!-- Донат-диаграмма -->
        <div class="flex items-center justify-center">
          <svg viewBox="0 0 36 36" class="w-40 h-40 rotate-[-90deg]">
            <circle cx="18" cy="18" r="15.915" fill="none" stroke="#F5CFCC" stroke-width="4"></circle>
            <circle cx="18" cy="18" r="15.915" fill="none" stroke="#C4314B" stroke-width="4" stroke-linecap="round"
                    stroke-dasharray="{{ percent }} 100"></circle>
          </svg>
          <div class="absolute text-3xl font-semibold" style="transform: translateY(0)">{{ percent|round(0) }}%</div>
        </div>

        <!-- Буллеты справа -->
        <ul class="space-y-2 text-sm">
          <li class="flex items-start gap-2"><span class="mt-1 w-2 h-2 rounded-full bg-brand-600"></span> Есть возможные несоответствия ФЗ «О рекламе»</li>
          <li class="flex items-start gap-2"><span class="mt-1 w-2 h-2 rounded-full bg-brand-500"></span> В соответствии с практикой риск привлечения к ответственности отсутствует</li>
          <li class="flex items-start gap-2"><span class="mt-1 w-2 h-2 rounded-full bg-brand-300"></span> Шанс привлечения к ответственности мал</li>
        </ul>
      </div>
    </div>

    <!-- Карточки нарушений -->
    {% for issue in issues %}
      <div class="bg-white rounded-2xl shadow-card p-5 border border-brand-200">
        <h3 class="text-lg font-semibold">{{ issue.title }}</h3>
        {% if issue.text %}<p class="mt-2 text-sm text-slate-800">{{ issue.text }}</p>{% endif %}
        <div class="mt-4">
          <div class="font-semibold">Рекомендация по исправлению</div>
          <p class="text-sm text-slate-700">{{ issue.fix }}</p>
        </div>
      </div>
    {% endfor %}

    <div class="flex items-center justify-center py-4">
      <a class="px-5 py-3 rounded-2xl text-white bg-brand-500 hover:bg-brand-600" href="/api/report/{{ check_id or 0 }}">Скачать PDF-отчёт</a>
    </div>
    <div class="text-center text-sm">Отчёт сохранён в <a href="/history" class="text-brand-700 hover:underline">Истории проверок</a></div>
  </section>

  <!-- Правая вертикальная шкала риска -->
  <aside class="lg:col-span-3">
    <div class="card flex flex-col items-center">
      <div class="w-full">
        <div class="risk-scale h-[420px] mx-auto">
          <div class="risk-scale__label" style="top: 8px;">Высокий</div>
          <div class="risk-scale__label" style="top: 50%; transform: translateY(-50%);">Средний</div>
          <div class="risk-scale__label" style="bottom: 8px;">Низкий</div>
          <div class="risk-scale__mark" style="top: calc({{ percent }}% - 6px);"></div>
        </div>
      </div>
    </div>
  </aside>
</div>
{% endblock %}